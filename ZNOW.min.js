/**
 * ZNOW JavaScript Framework v0.3.0
 * Copyright 2014, Icarus So
 * Licensed under the MIT or GPL Version 2 licenses.
 * Date: Apr 12 2015
 *
 * Copyright (C) 2014 by Icarus So
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
!function(){("undefined"==typeof console||"undefined"==typeof console.warn)&&(console={},console.warn=function(){});var n=function(){},t=function(){return n},r=function(n){return{val:void 0===n?null:n,__read:!0}},e=function(n){return{val:void 0===n?null:n,__const:!0}},i=function(){},a=function(n){return n.__final=!0,n},o=function(n){var t="",r=/^[_|$]*/.exec(n)[0];return t="$"+r+"on"+n.charAt(r.length).toUpperCase()+n.substr(r.length+1)},s=function(n,r){var e={};for(var a in n)/^static./.test(a)||n[a]instanceof Function&&(/^__/.test(a)||(n[a]!=t()?n[a]!=i?(e[a]=function(t){return function(){return n[t].apply(this,arguments)}}(a),n[a].__final&&(e[a].__final=!0)):e[o(a)]=function(n){return function(){var t=arguments,r=!0;return this["$$"+n].forEach(function(n){r&&(r=!(n.apply(this,t)===!1))}),r}}(a):e[a]=t()));if(e.init||e.$init||e._init||(e.init=function(){r.__baseClass&&this["super"].apply(this,arguments)}),r.__baseClass){var s=r.__baseClass.__methodSet;for(var a in s)if(s[a]instanceof Function&&"_"!=a[0]){if(e.hasOwnProperty(a)&&s[a].__final)throw new Error("WARN:: final mehtod cannot be overrided "+a);e.hasOwnProperty(a)||/^[_|$]?init$/.test(a)||(console.log("base",a,s[a]),e[a]=n[a]!=t()?s[a]==t()?t():function(n){return function(){return s[n].apply(this,arguments)}}(a):t())}}for(var a in e)e[a]._=r;return e},c=function(n){var t=function(t){for(var r in n)/^static./.test(r)||n[r]instanceof Function&&n[r]!=i||/^__/.test(r)||(n[r].__read?(this[r]=n[r].val,this["__read"+r]=!0):n[r].__const?(this[r]=n[r].val,this["__const"+r]=!0):n[r]!=i?this[r]=n[r]:this["$$"+r]=[]);if(t)for(var r in t)"_"!=r[0]&&(n[r]||Object.defineProperty(this,r,{get:function(n){return function(){return t[n]}}(r),set:function(n){return function(r){return t["__read"+n]&&"$"==n[0]?void console.warn("WARN:: accessing read only attr "+n):t[n]=r}}(r)}))};return t},u=function(n,t,r){if(!n)return!1;if(n._){var e=n._;if("_"==r[0])return e==t;do{if(e==t)return n._;e=e.__baseClass}while(e);return!1}return u(n.caller,t,r)},f=function(n,r){var e={},a=[];for(var s in n)if(/^static./.test(s)){var c=s.substr(7);if(n[s].__const)e[c]=n[s].val,e["__const"+c]=!0;else if(n[s].__read)e[c]=n[s].val,e["__read"+c]=!0;else if(n[s]==i)a.push(c);else{if(n[s]==t())throw new Error("static method cannot be abstract "+c);e[c]=n[s]}e[c]instanceof Function&&(e[c]._=r)}for(var f=0;f<a.length;f++){var c=a[f];e["$$"+c]=[],e[o(c)]=function(n){return function(){var t=arguments,r=!0;return this["$$"+n].forEach(function(n){r&&(r=!(n.apply(this,t)===!1))}),r}}(c),e[o(c)]._=r}if(e.on=function(n,t,r){return this["$$"+n]&&-1==this["$$"+n].indexOf(t)?(r?this["$$"+n].unshift(t):this["$$"+n].push(t),t):!1},e.on._=r,e.off=function(n,t){if(this["$$"+n]&&-1!=this["$$"+n].indexOf(t)){var r=this["$$"+n].indexOf(t);return this["$$"+n].splice(r,1),!0}return!1},e.off._=r,r.__baseClass){var l=r.__baseClass.__staticSet,_=r.__baseClass;for(var s in l){if(l[s]instanceof Function&&e.hasOwnProperty(s)&&_[s].__final)throw new Error("WARN:: final static method cannot be overrided "+s);e.hasOwnProperty(s)||(l[s]instanceof Function?(e[s]=function(n){return function(){return _[n].apply(this,arguments)}}(s),e[s]._=r):Object.defineProperty(e,s,{get:function(n){return function(){return _[n]}}(s),set:function(n){return function(t){return _[n]=t}}(s)}))}}for(var s in e)e[s]instanceof Function?(r[s]=function(n){return function(){return!/^[_|$]/.test(n)||u(arguments.callee.caller,r,n)?e[n].apply(this,arguments):void console.warn("WARN:: cannnot access static method "+n)}}(s),e[s].__final&&(r[s].__final=!0)):Object.defineProperty(r,s,{get:function(n){return function(){return!/^[_|$]/.test(n)||u(arguments.callee.caller,r,n)?e[n]:void console.warn("WARN:: cannnot access static attribute "+n)}}(s),set:function(n){return e["__const"+n]?function(){console.warn("WARN:: cannot change const static attribute "+n)}:e["__read"+n]?function(t){var i=u(arguments.callee.caller,r,n);if(i){if("$"!=n[0]||i==r)return e[n]=t;console.warn("WARN:: cannot change readonly attribute "+n)}else console.warn("WARN:: cannot change readonly attribute "+n)}:function(t){return!/^[_|$]/.test(n)||u(arguments.callee.caller,r,n)?e[n]=t:void console.warn("WARN:: cannnot access static attribute "+n)}}(s)});return e},l=function(n){var t=[];do t.push(n),n=n.__baseClass;while(n);return t.reverse()},_=function(n){var t=[];t[0]=new n[0].__attrTemp;for(var r=1;r<n.length;r++)t[r]=new n[r].__attrTemp(t[r-1]);for(var r=0;r<t.length;r++){var e=t[r];for(var i in e)Array.isArray(e[i])?e[i]=e[i].slice():e[i]instanceof Object&&0==Object.keys(e[i]).length&&(e[i]={})}return t},h=function(n){return n.map(function(n){return n.__methodSet})},v=function(n,t){for(var r={},e=n.length-1;e>=0;e--){var i=n[e],a=t[e];for(var o in i)r.hasOwnProperty(o)||(r[o]=i[o]);for(var o in a)r.hasOwnProperty(o)||(r[o]=a[o])}return r},d=function(n,t){return n?n._?t.indexOf(n._):d(n.caller,t):-1},p=function(n,r,e){for(;e[n][r]==t();)n++;return n},g=function(n,t,r){return"_"!=t[0]?r.length-1:n},w=function(n,r,e,i){var a=function(){var n=d(arguments.callee.caller,i),t=arguments[0];return t._=i[n],t};a.__initialized=!1;for(var o in n)n[o]instanceof Function?a[o]=function(n){return function(){var t=d(arguments.callee.caller,i);if(-1==t){if("_"!=n[0]&&"$"!=n[0]){var t=r.length-1;return r[t][n].apply(a,arguments)}console.warn("WARN:: public accessing private or protected method "+n)}else{if(r[t].hasOwnProperty(n))return t=g(t,n,r),r[t][n].apply(a,arguments);if("_"!=n[0]&&"$"!=n[0]){var t=r.length-1;return r[t][n].apply(a,arguments)}console.warn("WARN:: base accessing extended private or protected method "+n)}}}(o):Object.defineProperty(a,o,{get:function(n){return function(){var t=d(arguments.callee.caller,i);if(-1==t){if("_"!=n[0]&&"$"!=n[0]){var t=e.length-1;return e[t][n]}console.warn("WARN:: public accessing private or protected method "+n)}else{if(e[t].hasOwnProperty(n))return e[t][n];if("_"!=n[0]&&"$"!=n[0]){var t=r.length-1;return e[t][n]}console.warn("WARN:: base accessing extended private or protected attribute "+n)}}}(o),set:function(n){return function(t){var o=d(arguments.callee.caller,i);if(-1==o){if("_"!=n[0]&&"$"!=n[0]){var o=e.length-1;return e[o]["__read"+n]?void console.warn("WARN:: public accessing read only attribute "+n):a.__initialized&&e[o]["__const"+n]?void console.warn("WARN:: cannot change cost attribute "+n):e[o][n]=t}console.warn("WARN:: public accessing private or protected method "+n)}else{if(a.__initialized&&e[o]["__const"+n])return void console.warn("WARN:: cannot change cost attribute "+n);if(e[o].hasOwnProperty(n))return e[o][n]=t;if("_"!=n[0]&&"$"!=n[0]){var o=r.length-1;return e[o]["__read"+n]?void console.warn("WARN:: accessing read only attribute "+n):e[o][n]=t}console.warn("WARN:: base accessing extended private or protected attribute "+n)}}}(o)});var s=function(){var n=d(arguments.callee.caller,i);m(r,n-1,a,arguments)};for(var o in n)n[o]instanceof Function?s[o]=function(n){return function(){var e=d(arguments.callee.caller,i);return r[e].hasOwnProperty(n)?r[e-1][n]==t()?(e=p(e-1,n,r),r[e][n].apply(a,arguments)):r[e-1][n].apply(a,arguments):void console.warn("WARN:: super does not have such method "+n)}}(o):Object.defineProperty(s,o,{get:function(n){return function(){var t=d(arguments.callee.caller,i);return e[t].hasOwnProperty(n)?e[t-1][n]:void console.warn("WARN:: super does not have such attr "+n)}}(o),set:function(n){return function(t){var r=d(arguments.callee.caller,i);return e[r].hasOwnProperty(n)?e[r-1]["__read"+n]?void console.warn("WARN:: accessing read only attribute "+n):a.__initialized&&e[r]["__const"+n]?void console.warn("WARN:: cannot change cost attribute "+n):e[r-1][n]=t:void console.warn("WARN:: super does not have such attr "+n)}}(o)});return Object.defineProperty(a,"super",{get:function(){var n=d(arguments.callee.caller,i);if(-1==n)console.warn("WARN:: public access super");else{if(0!=n)return s;console.warn("WARN:: no super for this class")}}}),a.on=function(n,t,r){return this["$$"+n]&&-1==this["$$"+n].indexOf(t)?(r?this["$$"+n].unshift(t):this["$$"+n].push(t),t):!1},a.on._=i[0],a.off=function(n,t){if(this["$$"+n]&&-1!=this["$$"+n].indexOf(t)){var r=this["$$"+n].indexOf(t);return this["$$"+n].splice(r,1),!0}return!1},a.off._=i[0],a["class"]=i[i.length-1],a.instanceOf=function(n){return-1!=i.indexOf(n)},a},m=function(n,t,r,e,i){var a;if(i&&(a=d(e.callee.caller,i)),n[t].hasOwnProperty("init"))n[t].init.apply(r,e);else if(n[t].hasOwnProperty("$init")){if(-1==a)throw new Error("accessing protected constructor");n[t].$init.apply(r,e)}else if(n[t].hasOwnProperty("_init")){if(-1==a)throw new Error("accessing private constructor");n[t]._init.apply(r,e)}r.__initialized=!0},$=function(n,r){for(var e in n)if(n[e]==t())throw new Error("WARN:: some methods have not been implemented "+e);for(var e in r)if(!n[e])throw new Error("some methods have not been implemented "+e)},b=function(n,t){for(var r={},e=0;e<n.length;e++){var i=n[e];for(var a in i)r[a]=!0}for(var a in t)if(!r[a])throw new Error("some methods have not been implemented "+a)},y=function(n){n instanceof Array||(n=[n]);for(var t={},r=0;r<n.length;r++){var e=n[r];for(var i in e)t[i]=e[i]}return t},A=function(n){var t={};for(var r in n)t[r]=n[r];return t},O=function(n){var t=function(){if(!(this instanceof t)){var n=arguments[0];if(n instanceof Function)return n._=t,n;throw new Error("Class must be initialized with new operator")}var i=_(r),a=v(e,i);$(a,t.__intf);var o=w(a,e,i,r);return m(e,e.length-1,o,arguments,r),o};n.__baseClass&&(t.__baseClass=n.__baseClass),t.__methodSet=s(n,t),t.__attrTemp=c(n),t.__module=n,t.__staticSet=f(n,t),t.__intf=n.__intf;var r=l(t),e=h(r);return b(e,t.__intf),t};O["extends"]=function(n){var t=function(t){var r=A(t);return r.__baseClass=n,O(r)};return t["implements"]=function(t){return function(r){var e=A(r);return e.__baseClass=n,e.__intf=y(t),O(e)}},t},O["implements"]=function(n){var t=y(n);return function(n){return n.__intf=t,O(n)}},O.pretends=function(n){var t=function(t){var r=A(n.__module);for(var e in t)r[e]=t[e];return O(r)};return t["implements"]=function(t){return function(r){var e=A(n.__module);for(var i in r)e[i]=r[i];return e.__intf=y(t),O(e)}},t};var N=function(n){var r={};for(var e in n){if("_"==e[0])throw new Error("Interface cannot delare private methods; invalid method "+e);if(n[e]!=t()&&n[e]!=i)throw new Error("Interface methods must be abstract; invalidmethod "+e);r[e]=t()}return r};N["extends"]=function(n){return n instanceof Array||(n=[n]),function(t){n.push(t);for(var r={},e=0;e<n.length;e++){var i=n[e];for(var a in i)r[a]=i[a]}return N(r)}};var R;"undefined"!=typeof window?R=window:"undefined"!=typeof GLOBAL&&(R=GLOBAL),R.ABSTRACT=t,R.READ=r,R.CONST=e,R.EVENT=i,R.FINAL=a,R.Class=O,R.Interface=N}();