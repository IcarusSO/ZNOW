/**
 * ZNOW JavaScript Framework v0.3.1
 * Copyright 2014, Icarus So, Peter Denev
 * Licensed under the MIT or GPL Version 2 licenses.
 * Date: June 09 2015
 *
 * Copyright (C) 2014 by Icarus So
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
 !function(n,t){if("function"==typeof define&&define.amd)define("ZNOW",[],t);else if("object"==typeof exports)module.exports=t();else{n.ZNOW=t();for(var e in n.ZNOW)n[e]=n.ZNOW[e]}}(this,function(){("undefined"==typeof console||"undefined"==typeof console.warn)&&(console={},console.warn=function(){});var n=function(){},t=function(){return n},e=function(n){return{val:void 0===n?null:n,__read:!0}},r=function(n){return{val:void 0===n?null:n,__const:!0}},i=function(){},a=function(n){return n.__final=!0,n},o=function(n){var t="",e=/^[_|$]*/.exec(n)[0];return t="$"+e+"on"+n.charAt(e.length).toUpperCase()+n.substr(e.length+1)},s=function(n,e){var r={};for(var a in n)/^static./.test(a)||n[a]instanceof Function&&(/^__/.test(a)||(n[a]!=t()?n[a]!=i?(r[a]=function(t){return function(){return n[t].apply(this,arguments)}}(a),n[a].__final&&(r[a].__final=!0)):r[o(a)]=function(n){return function(){var t=arguments,e=!0;return this["$$"+n].forEach(function(n){e&&(e=!(n.apply(this,t)===!1))}),e}}(a):r[a]=t()));if(r.init||r.$init||r._init||(r.init=function(){e.__baseClass&&this["super"].apply(this,arguments)}),e.__baseClass){var s=e.__baseClass.__methodSet;for(var a in s)if(s[a]instanceof Function&&"_"!=a[0]){if(r.hasOwnProperty(a)&&s[a].__final)throw new Error("WARN:: final mehtod cannot be overrided "+a);r.hasOwnProperty(a)||/^[_|$]?init$/.test(a)||(console.log("base",a,s[a]),r[a]=n[a]!=t()?s[a]==t()?t():function(n){return function(){return s[n].apply(this,arguments)}}(a):t())}}for(var a in r)r[a]._=e;return r},c=function(n){var t=function(t){for(var e in n)if(!/^static./.test(e)&&!(n[e]instanceof Function&&n[e]!=i||/^__/.test(e))){if(null!=n[e]&&"undefined"!=typeof n[e]){if(n[e].__read){this[e]=n[e].val,this["__read"+e]=!0;continue}if(n[e].__const){this[e]=n[e].val,this["__const"+e]=!0;continue}}n[e]!=i?this[e]=n[e]:this["$$"+e]=[]}if(t)for(var e in t)"_"!=e[0]&&(n[e]||Object.defineProperty(this,e,{get:function(n){return function(){return t[n]}}(e),set:function(n){return function(e){return t["__read"+n]&&"$"==n[0]?void console.warn("WARN:: accessing read only attr "+n):t[n]=e}}(e)}))};return t},u=function(n,t,e){if(!n)return!1;if(n._){var r=n._;if("_"==e[0])return r==t;do{if(r==t)return n._;r=r.__baseClass}while(r);return!1}return u(n.caller,t,e)},f=function(n,e){var r={},a=[];for(var s in n)if(/^static./.test(s)){var c=s.substr(7);if(n[s].__const)r[c]=n[s].val,r["__const"+c]=!0;else if(n[s].__read)r[c]=n[s].val,r["__read"+c]=!0;else if(n[s]==i)a.push(c);else{if(n[s]==t())throw new Error("static method cannot be abstract "+c);r[c]=n[s]}r[c]instanceof Function&&(r[c]._=e)}for(var f=0;f<a.length;f++){var c=a[f];r["$$"+c]=[],r[o(c)]=function(n){return function(){var t=arguments,e=!0;return this["$$"+n].forEach(function(n){e&&(e=!(n.apply(this,t)===!1))}),e}}(c),r[o(c)]._=e}if(r.on=function(n,t,e){return this["$$"+n]&&-1==this["$$"+n].indexOf(t)?(e?this["$$"+n].unshift(t):this["$$"+n].push(t),t):!1},r.on._=e,r.off=function(n,t){if(this["$$"+n]&&-1!=this["$$"+n].indexOf(t)){var e=this["$$"+n].indexOf(t);return this["$$"+n].splice(e,1),!0}return!1},r.off._=e,e.__baseClass){var l=e.__baseClass.__staticSet,_=e.__baseClass;for(var s in l){if(l[s]instanceof Function&&r.hasOwnProperty(s)&&_[s].__final)throw new Error("WARN:: final static method cannot be overrided "+s);r.hasOwnProperty(s)||(l[s]instanceof Function?(r[s]=function(n){return function(){return _[n].apply(this,arguments)}}(s),r[s]._=e):Object.defineProperty(r,s,{get:function(n){return function(){return _[n]}}(s),set:function(n){return function(t){return _[n]=t}}(s)}))}}for(var s in r)r[s]instanceof Function?(e[s]=function(n){return function(){return!/^[_|$]/.test(n)||u(arguments.callee.caller,e,n)?r[n].apply(this,arguments):void console.warn("WARN:: cannnot access static method "+n)}}(s),r[s].__final&&(e[s].__final=!0)):Object.defineProperty(e,s,{get:function(n){return function(){return!/^[_|$]/.test(n)||u(arguments.callee.caller,e,n)?r[n]:void console.warn("WARN:: cannnot access static attribute "+n)}}(s),set:function(n){return r["__const"+n]?function(){console.warn("WARN:: cannot change const static attribute "+n)}:r["__read"+n]?function(t){var i=u(arguments.callee.caller,e,n);if(i){if("$"!=n[0]||i==e)return r[n]=t;console.warn("WARN:: cannot change readonly attribute "+n)}else console.warn("WARN:: cannot change readonly attribute "+n)}:function(t){return!/^[_|$]/.test(n)||u(arguments.callee.caller,e,n)?r[n]=t:void console.warn("WARN:: cannnot access static attribute "+n)}}(s)});return r},l=function(n){var t=[];do t.push(n),n=n.__baseClass;while(n);return t.reverse()},_=function(n){var t=[];t[0]=new n[0].__attrTemp;for(var e=1;e<n.length;e++)t[e]=new n[e].__attrTemp(t[e-1]);for(var e=0;e<t.length;e++){var r=t[e];for(var i in r)Array.isArray(r[i])?r[i]=r[i].slice():r[i]instanceof Object&&0==Object.keys(r[i]).length&&(r[i]={})}return t},h=function(n){return n.map(function(n){return n.__methodSet})},v=function(n,t){for(var e={},r=n.length-1;r>=0;r--){var i=n[r],a=t[r];for(var o in i)e.hasOwnProperty(o)||(e[o]=i[o]);for(var o in a)e.hasOwnProperty(o)||(e[o]=a[o])}return e},d=function(n,t,e){return e="undefined"!=typeof e?e:0,n?n._?t.indexOf(n._):e>20?-1:d(n.caller,t,++e):-1},p=function(n,e,r){for(;r[n][e]==t();)n++;return n},m=function(n,t,e){return"_"!=t[0]?e.length-1:n},g=function(n,e,r,i){var a=function(){var n=d(arguments.callee.caller,i),t=arguments[0];return t._=i[n],t};a.__initialized=!1;for(var o in n)n[o]instanceof Function?a[o]=function(n){return function(){var t=d(arguments.callee.caller,i);if(-1==t){if("_"!=n[0]&&"$"!=n[0]){var t=e.length-1;return e[t][n].apply(a,arguments)}console.warn("WARN:: public accessing private or protected method "+n)}else{if(e[t].hasOwnProperty(n))return t=m(t,n,e),e[t][n].apply(a,arguments);if("_"!=n[0]&&"$"!=n[0]){var t=e.length-1;return e[t][n].apply(a,arguments)}console.warn("WARN:: base accessing extended private or protected method "+n)}}}(o):Object.defineProperty(a,o,{get:function(n){return function(){var t=d(arguments.callee.caller,i);if(-1==t){if("_"!=n[0]&&"$"!=n[0]){var t=r.length-1;return r[t][n]}console.warn("WARN:: public accessing private or protected method "+n)}else{if(r[t].hasOwnProperty(n))return r[t][n];if("_"!=n[0]&&"$"!=n[0]){var t=e.length-1;return r[t][n]}console.warn("WARN:: base accessing extended private or protected attribute "+n)}}}(o),set:function(n){return function(t){var o=d(arguments.callee.caller,i);if(-1==o){if("_"!=n[0]&&"$"!=n[0]){var o=r.length-1;return r[o]["__read"+n]?void console.warn("WARN:: public accessing read only attribute "+n):a.__initialized&&r[o]["__const"+n]?void console.warn("WARN:: cannot change cost attribute "+n):r[o][n]=t}console.warn("WARN:: public accessing private or protected method "+n)}else{if(a.__initialized&&r[o]["__const"+n])return void console.warn("WARN:: cannot change cost attribute "+n);if(r[o].hasOwnProperty(n))return r[o][n]=t;if("_"!=n[0]&&"$"!=n[0]){var o=e.length-1;return r[o]["__read"+n]?void console.warn("WARN:: accessing read only attribute "+n):r[o][n]=t}console.warn("WARN:: base accessing extended private or protected attribute "+n)}}}(o)});var s=function(){var n=d(arguments.callee.caller,i);w(e,n-1,a,arguments)};for(var o in n)n[o]instanceof Function?s[o]=function(n){return function(){var r=d(arguments.callee.caller,i);return e[r].hasOwnProperty(n)?e[r-1][n]==t()?(r=p(r-1,n,e),e[r][n].apply(a,arguments)):e[r-1][n].apply(a,arguments):void console.warn("WARN:: super does not have such method "+n)}}(o):Object.defineProperty(s,o,{get:function(n){return function(){var t=d(arguments.callee.caller,i);return r[t].hasOwnProperty(n)?r[t-1][n]:void console.warn("WARN:: super does not have such attr "+n)}}(o),set:function(n){return function(t){var e=d(arguments.callee.caller,i);return r[e].hasOwnProperty(n)?r[e-1]["__read"+n]?void console.warn("WARN:: accessing read only attribute "+n):a.__initialized&&r[e]["__const"+n]?void console.warn("WARN:: cannot change cost attribute "+n):r[e-1][n]=t:void console.warn("WARN:: super does not have such attr "+n)}}(o)});return Object.defineProperty(a,"super",{get:function(){var n=d(arguments.callee.caller,i);if(-1==n)console.warn("WARN:: public access super");else{if(0!=n)return s;console.warn("WARN:: no super for this class")}}}),a.on=function(n,t,e){return this["$$"+n]&&-1==this["$$"+n].indexOf(t)?(e?this["$$"+n].unshift(t):this["$$"+n].push(t),t):!1},a.on._=i[0],a.off=function(n,t){if(this["$$"+n]&&-1!=this["$$"+n].indexOf(t)){var e=this["$$"+n].indexOf(t);return this["$$"+n].splice(e,1),!0}return!1},a.off._=i[0],a["class"]=i[i.length-1],a.instanceOf=function(n){return-1!=i.indexOf(n)},a},w=function(n,t,e,r,i){var a;if(i&&(a=d(r.callee.caller,i)),n[t].hasOwnProperty("init"))n[t].init.apply(e,r);else if(n[t].hasOwnProperty("$init")){if(-1==a)throw new Error("accessing protected constructor");n[t].$init.apply(e,r)}else if(n[t].hasOwnProperty("_init")){if(-1==a)throw new Error("accessing private constructor");n[t]._init.apply(e,r)}e.__initialized=!0},$=function(n,e){for(var r in n)if(n[r]==t())throw new Error("WARN:: some methods have not been implemented "+r);for(var r in e)if(!n[r])throw new Error("some methods have not been implemented "+r)},b=function(n,t){for(var e={},r=0;r<n.length;r++){var i=n[r];for(var a in i)e[a]=!0}for(var a in t)if(!e[a])throw new Error("some methods have not been implemented "+a)},y=function(n){n instanceof Array||(n=[n]);for(var t={},e=0;e<n.length;e++){var r=n[e];for(var i in r)t[i]=r[i]}return t},O=function(n){var t={};for(var e in n)t[e]=n[e];return t},A=function(n){if(n.hasOwnProperty("_")&&n._.hasOwnProperty("__module")){var t=["init","$init","_init"];for(var e in t)if(n._.__module.hasOwnProperty(t[e]))return n._.__module[t[e]].name}return"__ANONYMOUS_ZNOW_CLASS__"},N=function(n){var t=function(){if(!(this instanceof t)){var n=arguments[0];if(n instanceof Function)return n._=t,n;throw new Error("Class must be initialized with new operator")}var i=_(e),a=v(r,i);$(a,t.__intf);var o=g(a,r,i,e);return w(r,r.length-1,o,arguments,e),o};n.__baseClass&&(t.__baseClass=n.__baseClass),t.__methodSet=s(n,t),t.__attrTemp=c(n),t.__module=n,t.__staticSet=f(n,t),t.__intf=n.__intf;var e=l(t),r=h(e);return b(r,t.__intf),t.constructorName=A(r[0].init),t};N["extends"]=function(n){var t=function(t){var e=O(t);return e.__baseClass=n,N(e)};return t["implements"]=function(t){return function(e){var r=O(e);return r.__baseClass=n,r.__intf=y(t),N(r)}},t},N["implements"]=function(n){var t=y(n);return function(n){return n.__intf=t,N(n)}},N.pretends=function(n){var t=function(t){var e=O(n.__module);for(var r in t)e[r]=t[r];return N(e)};return t["implements"]=function(t){return function(e){var r=O(n.__module);for(var i in e)r[i]=e[i];return r.__intf=y(t),N(r)}},t};var W=function(n){var e={};for(var r in n){if("_"==r[0])throw new Error("Interface cannot delare private methods; invalid method "+r);if(n[r]!=t()&&n[r]!=i)throw new Error("Interface methods must be abstract; invalidmethod "+r);e[r]=t()}return e};return W["extends"]=function(n){return n instanceof Array||(n=[n]),function(t){n.push(t);for(var e={},r=0;r<n.length;r++){var i=n[r];for(var a in i)e[a]=i[a]}return W(e)}},{ABSTRACT:t,READ:e,CONST:r,EVENT:i,FINAL:a,Class:N,Interface:W}});