/**
 * ZNOW JavaScript Framework v0.3.1
 * Copyright 2014, Icarus So, Peter Denev
 * Licensed under the MIT or GPL Version 2 licenses.
 * Date: June 09 2015
 *
 * Copyright (C) 2014 by Icarus So
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
 !function(n,e){if("function"==typeof define&&define.amd)define("ZNOW",[],e);else if("object"==typeof exports)module.exports=e();else{n.ZNOW=e();for(var t in n.ZNOW)n[t]=n.ZNOW[t]}}(this,function(){("undefined"==typeof console||"undefined"==typeof console.warn)&&(console={},console.warn=function(){});var n=function(){},e=function(){return n},t=function(n){return{val:void 0===n?null:n,__read:!0}},r=function(n){return{val:void 0===n?null:n,__const:!0}},i=function(){},a=function(n){return n.__final=!0,n},o=function(n){var e="",t=/^[_|$]*/.exec(n)[0];return e="$"+t+"on"+n.charAt(t.length).toUpperCase()+n.substr(t.length+1)},s=function(n,t){var r={};for(var a in n)/^static./.test(a)||n[a]instanceof Function&&(/^__/.test(a)||(n[a]!=e()?n[a]!=i?(r[a]=function(e){return function(){return n[e].apply(this,arguments)}}(a),n[a].__final&&(r[a].__final=!0)):r[o(a)]=function(n){return function(){var e=arguments,t=!0;return this["$$"+n].forEach(function(n){t&&(t=!(n.apply(this,e)===!1))}),t}}(a):r[a]=e()));if(r.init||r.$init||r._init||(r.init=function(){t.__baseClass&&this["super"].apply(this,arguments)}),t.__baseClass){var s=t.__baseClass.__methodSet;for(var a in s)if(s[a]instanceof Function&&"_"!=a[0]){if(r.hasOwnProperty(a)&&s[a].__final)throw new Error("WARN:: final mehtod cannot be overrided "+a);r.hasOwnProperty(a)||/^[_|$]?init$/.test(a)||(r[a]=n[a]!=e()?s[a]==e()?e():function(n){return function(){return s[n].apply(this,arguments)}}(a):e())}}for(var a in r)r[a]._=t;return r},c=function(n){var e=function(e){for(var t in n)if(!/^static./.test(t)&&!(n[t]instanceof Function&&n[t]!=i||/^__/.test(t))){if(null!=n[t]&&"undefined"!=typeof n[t]){if(n[t].__read){this[t]=n[t].val,this["__read"+t]=!0;continue}if(n[t].__const){this[t]=n[t].val,this["__const"+t]=!0;continue}}n[t]!=i?this[t]=n[t]:this["$$"+t]=[]}if(e)for(var t in e)"_"!=t[0]&&(n[t]||Object.defineProperty(this,t,{get:function(n){return function(){return e[n]}}(t),set:function(n){return function(t){return e["__read"+n]&&"$"==n[0]?void console.warn("WARN:: accessing read only attr "+n):e[n]=t}}(t)}))};return e},u=function(n,e,t){if(!n)return!1;if(n._){var r=n._;if("_"==t[0])return r==e;do{if(r==e)return n._;r=r.__baseClass}while(r);return!1}return u(n.caller,e,t)},f=function(n,t){var r={},a=[];for(var s in n)if(/^static./.test(s)){var c=s.substr(7);if(n[s].__const)r[c]=n[s].val,r["__const"+c]=!0;else if(n[s].__read)r[c]=n[s].val,r["__read"+c]=!0;else if(n[s]==i)a.push(c);else{if(n[s]==e())throw new Error("static method cannot be abstract "+c);r[c]=n[s]}r[c]instanceof Function&&(r[c]._=t)}for(var f=0;f<a.length;f++){var c=a[f];r["$$"+c]=[],r[o(c)]=function(n){return function(){var e=arguments,t=!0;return this["$$"+n].forEach(function(n){t&&(t=!(n.apply(this,e)===!1))}),t}}(c),r[o(c)]._=t}if(r.on=function(n,e,t){return this["$$"+n]&&-1==this["$$"+n].indexOf(e)?(t?this["$$"+n].unshift(e):this["$$"+n].push(e),e):!1},r.on._=t,r.off=function(n,e){if(this["$$"+n]&&-1!=this["$$"+n].indexOf(e)){var t=this["$$"+n].indexOf(e);return this["$$"+n].splice(t,1),!0}return!1},r.off._=t,t.__baseClass){var l=t.__baseClass.__staticSet,_=t.__baseClass;for(var s in l){if(l[s]instanceof Function&&r.hasOwnProperty(s)&&_[s].__final)throw new Error("WARN:: final static method cannot be overrided "+s);r.hasOwnProperty(s)||(l[s]instanceof Function?(r[s]=function(n){return function(){return _[n].apply(this,arguments)}}(s),r[s]._=t):Object.defineProperty(r,s,{get:function(n){return function(){return _[n]}}(s),set:function(n){return function(e){return _[n]=e}}(s)}))}}for(var s in r)r[s]instanceof Function?(t[s]=function(n){return function(){return!/^[_|$]/.test(n)||u(arguments.callee.caller,t,n)?r[n].apply(this,arguments):void console.warn("WARN:: cannnot access static method "+n)}}(s),r[s].__final&&(t[s].__final=!0)):Object.defineProperty(t,s,{get:function(n){return function(){return!/^[_|$]/.test(n)||u(arguments.callee.caller,t,n)?r[n]:void console.warn("WARN:: cannnot access static attribute "+n)}}(s),set:function(n){return r["__const"+n]?function(){console.warn("WARN:: cannot change const static attribute "+n)}:r["__read"+n]?function(e){var i=u(arguments.callee.caller,t,n);if(i){if("$"!=n[0]||i==t)return r[n]=e;console.warn("WARN:: cannot change readonly attribute "+n)}else console.warn("WARN:: cannot change readonly attribute "+n)}:function(e){return!/^[_|$]/.test(n)||u(arguments.callee.caller,t,n)?r[n]=e:void console.warn("WARN:: cannnot access static attribute "+n)}}(s)});return r},l=function(n){var e=[];do e.push(n),n=n.__baseClass;while(n);return e.reverse()},_=function(n){var e=[];e[0]=new n[0].__attrTemp;for(var t=1;t<n.length;t++)e[t]=new n[t].__attrTemp(e[t-1]);for(var t=0;t<e.length;t++){var r=e[t];for(var i in r)Array.isArray(r[i])?r[i]=r[i].slice():r[i]instanceof Object&&0==Object.keys(r[i]).length&&(r[i]={})}return e},h=function(n){return n.map(function(n){return n.__methodSet})},v=function(n,e){for(var t={},r=n.length-1;r>=0;r--){var i=n[r],a=e[r];for(var o in i)t.hasOwnProperty(o)||(t[o]=i[o]);for(var o in a)t.hasOwnProperty(o)||(t[o]=a[o])}return t},d=function(n,e,t){return t="undefined"!=typeof t?t:0,n?n._?e.indexOf(n._):t>20?-1:d(n.caller,e,++t):-1},p=function(n,t,r){for(;r[n][t]==e();)n++;return n},m=function(n,e,t){return"_"!=e[0]?t.length-1:n},g=function(n,t,r,i){var a=function(){var n=d(arguments.callee.caller,i),e=arguments[0];return e._=i[n],e};a.__initialized=!1;for(var o in n)n[o]instanceof Function?a[o]=function(n){return function(){var e=d(arguments.callee.caller,i);if(-1==e){if("_"!=n[0]&&"$"!=n[0]){var e=t.length-1;return t[e][n].apply(a,arguments)}console.warn("WARN:: public accessing private or protected method "+n)}else{if(t[e].hasOwnProperty(n))return e=m(e,n,t),t[e][n].apply(a,arguments);if("_"!=n[0]){var e=t.length-1;return t[e][n].apply(a,arguments)}console.warn("WARN:: base accessing extended private method "+n)}}}(o):Object.defineProperty(a,o,{get:function(n){return function(){for(var e=d(arguments.callee.caller,i),t=r.length-1;t>=0;){if(r[t].hasOwnProperty(n)){if("_"!=n[0]&&"$"!=n[0]||-1!=e){if("_"==n[0]&&e!=t){if(e>t){console.warn("WARN:: class accessing base private attribute "+n);break}console.warn("WARN:: base accessing extended private attribute "+n);break}return r[t][n]}console.warn("WARN:: public accessing private or protected method "+n);break}t--}}}(o),set:function(n){return function(e){var o=d(arguments.callee.caller,i);if(-1==o){if("_"!=n[0]&&"$"!=n[0]){var o=r.length-1;return r[o]["__read"+n]?void console.warn("WARN:: public accessing read only attribute "+n):a.__initialized&&r[o]["__const"+n]?void console.warn("WARN:: cannot change const attribute "+n):r[o][n]=e}console.warn("WARN:: public accessing private or protected method "+n)}else{if(a.__initialized&&r[o]["__const"+n])return void console.warn("WARN:: cannot change const attribute "+n);if(r[o].hasOwnProperty(n))return r[o][n]=e;if("_"!=n[0]){var o=t.length-1;return r[o]["__read"+n]?void console.warn("WARN:: accessing read only attribute "+n):r[o][n]=e}console.warn("WARN:: base accessing extended private attribute "+n)}}}(o)});var s=function(){var n=d(arguments.callee.caller,i);w(t,n-1,a,arguments)};for(var o in n)n[o]instanceof Function?s[o]=function(n){return function(){var r=d(arguments.callee.caller,i);return t[r].hasOwnProperty(n)?t[r-1][n]==e()?(r=p(r-1,n,t),t[r][n].apply(a,arguments)):t[r-1][n].apply(a,arguments):void console.warn("WARN:: super does not have such method "+n)}}(o):Object.defineProperty(s,o,{get:function(n){return function(){var e=d(arguments.callee.caller,i);return r[e].hasOwnProperty(n)?r[e-1][n]:void console.warn("WARN:: super does not have such attr "+n)}}(o),set:function(n){return function(e){var t=d(arguments.callee.caller,i);return r[t].hasOwnProperty(n)?r[t-1]["__read"+n]?void console.warn("WARN:: accessing read only attribute "+n):a.__initialized&&r[t]["__const"+n]?void console.warn("WARN:: cannot change cost attribute "+n):r[t-1][n]=e:void console.warn("WARN:: super does not have such attr "+n)}}(o)});return Object.defineProperty(a,"super",{get:function(){var n=d(arguments.callee.caller,i);if(-1==n)console.warn("WARN:: public access super");else{if(0!=n)return s;console.warn("WARN:: no super for this class")}}}),a.on=function(n,e,t){return this["$$"+n]&&-1==this["$$"+n].indexOf(e)?(t?this["$$"+n].unshift(e):this["$$"+n].push(e),e):!1},a.on._=i[0],a.off=function(n,e){if(this["$$"+n]&&-1!=this["$$"+n].indexOf(e)){var t=this["$$"+n].indexOf(e);return this["$$"+n].splice(t,1),!0}return!1},a.off._=i[0],a["class"]=i[i.length-1],a.instanceOf=function(n){return-1!=i.indexOf(n)||-1!=a["class"].__interfaceSet.indexOf(n)},a},w=function(n,e,t,r,i){var a;if(i&&(a=d(r.callee.caller,i)),n[e].hasOwnProperty("init"))n[e].init.apply(t,r);else if(n[e].hasOwnProperty("$init")){if(-1==a)throw new Error("accessing protected constructor");n[e].$init.apply(t,r)}else if(n[e].hasOwnProperty("_init")){if(-1==a)throw new Error("accessing private constructor");n[e]._init.apply(t,r)}t.__initialized=!0},b=function(n,t){for(var r in n)if(n[r]==e())throw new Error("WARN:: some methods have not been implemented "+r);for(var r in t)if(!n[r])throw new Error("some methods have not been implemented "+r)},y=function(n,e){for(var t={},r=0;r<n.length;r++){var i=n[r];for(var a in i)t[a]=!0}for(var a in e)if(!t[a])throw new Error("some methods have not been implemented "+a)},$=function(n){n instanceof Array||(n=[n]);for(var e={},t=0;t<n.length;t++){var r=n[t];for(var i in r)e[i]=r[i]}return e},O=function(n){var e={};for(var t in n)e[t]=n[t];return e},A=function(n){var e=["init","$init","_init"];for(var t in e)if(n.hasOwnProperty(e[t]))return n[e[t]].name;return"__ANONYMOUS_ZNOW_CLASS__"},N=function(n){var e=function(){if(!(this instanceof e)){var n=arguments[0];if(n instanceof Function)return n._=e,n;throw new Error("Class must be initialized with new operator")}var i=_(t),a=v(r,i);b(a,e.__intf);var o=g(a,r,i,t);return w(r,r.length-1,o,arguments,t),o};n.__baseClass&&(e.__baseClass=n.__baseClass),e.__interfaceSet=n.__interfaceSet?n.__interfaceSet:[],e.__methodSet=s(n,e),e.__attrTemp=c(n),e.__module=n,e.__staticSet=f(n,e),e.__intf=n.__intf;var t=l(e),r=h(t);return y(r,e.__intf),e.constructorName=A(e.__module),e};N["extends"]=function(n){var e=function(e){var t=O(e);return t.__baseClass=n,t.__interfaceSet=n.__interfaceSet.slice(0),N(t)};return e["implements"]=function(e){var t=e instanceof Array?e:[e];return function(r){var i=O(r);i.__baseClass=n,i.__intf=$(e),i.__interfaceSet=n.__interfaceSet.slice(0);for(var a in t)-1==i.__interfaceSet.indexOf(t[a])&&i.__interfaceSet.push(t[a]);return N(i)}},e},N["implements"]=function(n){var e=$(n),t=n instanceof Array?n:[n];return function(n){return n.__intf=e,n.__interfaceSet=t,N(n)}},N.pretends=function(n){var e=function(e){var t=O(n.__module);for(var r in e)t[r]=e[r];return N(t)};return e["implements"]=function(e){return function(t){var r=O(n.__module);for(var i in t)r[i]=t[i];return r.__intf=$(e),N(r)}},e};var W=function(n){var t={};for(var r in n){if("_"==r[0])throw new Error("Interface cannot delare private methods; invalid method "+r);if(n[r]!=e()&&n[r]!=i)throw new Error("Interface methods must be abstract; invalid method "+r);t[r]=e()}return t};return W["extends"]=function(n){return n instanceof Array||(n=[n]),function(e){n.push(e);for(var t={},r=0;r<n.length;r++){var i=n[r];for(var a in i)t[a]=i[a]}return W(t)}},{ABSTRACT:e,READ:t,CONST:r,EVENT:i,FINAL:a,Class:N,Interface:W}});